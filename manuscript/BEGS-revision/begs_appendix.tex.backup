
\documentclass[11.5pt,twoside]{article}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{chadstyle}

%TCIDATA{OutputFilter=Latex.dll}
%TCIDATA{Version=5.50.0.2960}
%TCIDATA{<META NAME="SaveForMode" CONTENT="1">}
%TCIDATA{BibliographyScheme=Manual}
%TCIDATA{LastRevised=Tuesday, April 15, 2014 12:00:45}
%TCIDATA{<META NAME="GraphicsSave" CONTENT="32">}

\newcommand{\proptitle}[1]{\color{ChadBlue} \textnormal{(#1):}}
\newtheorem{proposition}{\color{ChadGreen} Proposition}
\newcommand{\assume}[2]{{\bf{Assumption #1}} (#2)}
\newcommand{\clr}[1]{{\color{ChadBlue} #1}}
\newcommand{\clrg}[1]{{\color{ChadGreen} #1}}
\newcommand{\pioof}[2]{\newline {\hspace{-\parindent} {\color{ChadGreen}\bf Proof of Proposition}~\ref{#1}.}{\color{ChadBlue} #2} \vspace{.1in}}
\usepackage{amsfonts}
\usepackage{appendix}
\usepackage[pagewise,displaymath, mathlines]{lineno}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{color}
\usepackage{refcount}
\usepackage{natbib}
\usepackage{bm}
\usepackage{hyperref}
\usepackage{epstopdf}
\setcounter{MaxMatrixCols}{10}
\newtheorem{theorem}{Theorem}
\newtheorem{acknowledgement}[theorem]{Acknowledgement}
\newtheorem{algorithm}[theorem]{Algorithm}
\newtheorem{assumption}{Assumption}
\newtheorem{axiom}{Axiom}
\newtheorem{case}[theorem]{Case}
\newtheorem{claim}[theorem]{Claim}
\newtheorem{conclusion}[theorem]{Conclusion}
\newtheorem{condition}[theorem]{Condition}
\newtheorem{conjecture}{Conjecture}
\newtheorem{corollary}{Corollary}
\newtheorem{criterion}[theorem]{Criterion}
\newtheorem{definition}{Definition}
\newtheorem{lemma}{Lemma}
\newtheorem{problem}[theorem]{Problem}
\newtheorem{solution}[theorem]{Solution}
\newtheorem{summary}[theorem]{Summary}
\newtheorem{example}{Example}
\newtheorem{exercise}{Exercise}
\newtheorem{notation}{Notation}
\newtheorem{remark}{Remark}
\newcommand{\bmat}{\begin{matrix}}
\newcommand{\emat}{\end{matrix}}
\newcommand{\ov}{\overline}
\newcommand{\un}{\underline}
\newcommand{\EE}{\mathbb E}
\newcommand{\var}{\mathrm{var}}
\newcommand{\cov}{\mathrm{cov}}
\newcommand{\corr}{\mathrm{corr}}
\newcommand{\dd}{\displaystyle}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\FF}{\mathbb F}
\newcommand{\LL}{\mathbb L}
\newcommand{\MM}{\mathbb M}
\newcommand{\KK}{\mathbb K}
\newcommand{\HH}{\mathbb H}
\newcommand{\QQ}{\mathbb Q}
\newcommand{\CC}{\mathbb{C}}
\newcommand{\Pin}{P_{\text{in}}}
\newcommand{\bx}{\mathbf{x}}
\newcommand{\bp}{\mathbf{p}}
\newcommand{\by}{\mathbf{y}}
\newcommand{\cP}{{\cal P}}
\newcommand{\bB}{\mathbf B}
\newcommand{\bM}{\mathbf M}
\newcommand{\bS}{\mathbf S}
\newcommand{\phis}{\varphi}
\newcommand{\barphis}{\overline\phis}
\newcommand{\se}{\text{se}}
\newcommand{\daga}{a^\dagger}
\newcommand{\devides}{\bigl |}
\newcommand{\eval}{\biggl |}
\newcommand{\ybar}{\overline y}
\newcommand{\bWhat}{\hat{\mathbf W}}
\newcommand{\bW}{\mathbf W}
\newcommand{\bz}{\mathbf z}
\newcommand{\bs}{\mathbf s}
\newcommand{\rightas}{\stackrel{a.s.}{\rightarrow}}
\newcommand{\rightp}{\stackrel{p}{\rightarrow}}
\newcommand{\rightd}{\stackrel{d}{\rightarrow}}
\newcommand{\bI}{\mathbf I}
\newcommand{\barB}{{\overline B}}
\newcommand{\barC}{{\overline C}}
\newcommand{\pbar}{{\overline P}}
\newcommand{\bbar}{{\overline b}}
\newcommand{\mubar}{{\overline \mu}}

\newenvironment{proof}[1][Proof]{\noindent \textbf{#1.} }{\  \rule{0.5em}{0.5em}}
\topmargin=-1cm
\oddsidemargin=-0cm
\textheight=22.2cm
\textwidth=16cm
\setcounter{secnumdepth}{2}
\pagestyle{plain}
\setcounter{figure}{0}
%\setpagewiselinenumbers
%\linenumbers
\input{tcilatex}
\begin{document}
\newpage
\section{Appendix}
\appendix
\subsection{Proof of Theorem \protect\ref{prop: affine eqm nec and suff}}
\label{appndx: affine eqm nec and stuff}
\smallskip

We prove a slight more general version of our result. Consider an infinite
horizon, incomplete markets economy in which an agent maximizes utility
function $U:\mathbb{R}_{+}^{n}\rightarrow \mathbb{R}$ subject to an infinite
sequence of budget constraints. We assume that $U$ is concave and
differentiable. Let $\mathbf{x}(s^t)$ be a vector of $n$ goods and let $%
\mathbf{p}(s^{t})$ be a price vector in state $s^{t}$ with $p_{i}(s^{t})$
denoting the price of good $i.$ We use a normalization $p_{1}\left(
s^{t}\right) =1$ for all $s^{t}.$ There is a risk-free bond.

Let $b(s^{t})$ be the agent's bond holdings, and let $\mathbf{e}\left(
s^{t}\right) $ be a stochastic vector of endowments.

\textbf{Consumer maximization problem}

\begin{equation}
\max_{\mathbf{x}_{t},b_{t}}\sum_{t=0}^{\infty }\beta ^{t}\Pr \left(
s^{t}\right) U(\mathbf{x}\left( s^{t}\right) )
\label{Tech appendix: consumer maximization}
\end{equation}%
subject to%
\begin{equation}
\mathbf{p}\left( s^{t}\right) \mathbf{x}\left( s^{t}\right) +q(s^{t})b\left(
s^{t}\right) =\mathbf{p}\left( s^{t}\right) \mathbf{e}\left( s^{t}\right)
+P(s_t)b\left( s^{t-1}\right)  \label{Tech appendix: budget constraint}
\end{equation}%
and $\left \{ b\left( s^{t}\right) \right \} $ is bounded and $\left \{
q(s^{t})\right \} $ is the price of the risk-free bond.

The Euler conditions are%
\begin{eqnarray}
\mathbf{U}_{x}(s^{t}) &=&U_{1}(s^{t})\mathbf{p}(s^{t})
\label{Tech appendix: Euler} \\
\Pr \left( s^{t}\right) U_{1}\left( s^{t}\right) q(s^{t}) &=&\beta
\sum_{s^{t+1}>s^{t}}\Pr \left( s^{t+1}\right) U_{1}\left( s^{t+1}\right) .
\notag
\end{eqnarray}

\begin{proposition}
\smallskip Consider an allocation $\left \{ \mathbf{x}_{t},b_{t}\right \} $
that satisfies (\ref{Tech appendix: budget constraint}), (\ref{Tech
appendix: Euler}) and $\left \{ b_{t}\right \} _{t}$ is bounded. Then $%
\left
\{ \mathbf{x}_{t},b_{t}\right \} $ is a solution to (\ref{Tech
appendix: consumer maximization}).
\end{proposition}

\begin{proof}
The proof follows closely Constantinides and Duffie (1996). Suppose there is
another budget feasible allocation $\mathbf{x}+\mathbf{h}$ that maximizes (%
\ref{Tech appendix: consumer maximization}). Since $U$ is strictly concave,
\begin{eqnarray}
&&\mathbb{E}_{0}\sum_{t=0}^{\infty }\beta ^{t}U(\mathbf{x}_{t}+\mathbf{h}%
_{t})-\mathbb{E}_{0}\sum_{t=0}^{\infty }\beta ^{t}U(\mathbf{x}_{t})
\label{Tech appendix: gain from h} \\
&\leq &\mathbb{E}_{0}\sum_{t=0}^{\infty }\beta ^{t}\mathbf{U}_{x}(\mathbf{x}%
_{t})\mathbf{h}_{t}  \notag
\end{eqnarray}

To attain $\mathbf{x}+\mathbf{h}$, the agent must deviate by $\varphi _{t}$
from his original portfolio $b_{t}$ such that $\left\{ \varphi _{t}\right\}
_{t}$ is bounded$,$ $\varphi _{-1}=0$ and
\begin{equation*}
\mathbf{p}(s^{t})\mathbf{h}\left( s^{t}\right) =\varphi
(s^{t-1})-q(s^{t})\varphi (s^{t})
\end{equation*}%
Multiply by $\beta ^{t}\Pr \left( s^{t}\right) U_{1}(s^{t})$ to get:%
\begin{eqnarray*}
\beta ^{t}\Pr \left( s^{t}\right) U_{1}(s^{t})\mathbf{p}(s^{t})\mathbf{h}%
\left( s^{t}\right)  &=&\beta ^{t}\Pr \left( s^{t}\right)
U_{1}(s^{t})\varphi (s^{t-1})-q(s^{t})\beta ^{t}\Pr \left( s^{t}\right)
U_{1}(s^{t})\varphi (s^{t}) \\
&=&\beta ^{t}\Pr \left( s^{t}\right) U_{1}(s^{t})\varphi (s^{t-1})-\beta
^{t+1}\sum_{s^{t+1}>s^{t}}\Pr \left( s^{t+1}\right) U_{1}\left(
s^{t+1}\right) \varphi (s^{t})
\end{eqnarray*}%
where we used the second part of (\ref{Tech appendix: Euler}) in the second
equality. Sum over the first $T$ periods and use the first part of (\ref%
{Tech appendix: Euler}) to eliminate $\mathbf{U}_{x}(\mathbf{x}%
_{t})=U_{1}(s^{t})\mathbf{p}(s^{t})$%
\begin{equation*}
\sum_{t=0}^{T}\beta ^{t}\Pr \left( s^{t}\right) \mathbf{U}_{x}(\mathbf{x}%
_{t})\mathbf{h}\left( s^{t}\right) =-\sum_{s^{T+1}>s^{T}}\beta ^{T+1}\Pr
\left( s^{T+1}\right) U_{1}\left( s^{T+1}\right) \varphi (s^{T}).
\end{equation*}%
Since $\left\{ \varphi _{t}\right\} _{t}$ is bounded there must exist $\bar{%
\varphi}$ s.t. $|\varphi _{t}|\leq \bar{\varphi}$ for all $t$. By Theorem
5.2 of Magill and Quinzii (1994), this equilibrium with debt constraints
implies a transversality condition on the right hand side of the last
equation, so by transitivity we have%
\begin{equation*}
\lim_{T\rightarrow \infty }\sum_{t=0}^{T}\beta ^{t}\Pr \left( s^{t}\right)
\mathbf{U}_{x}(\mathbf{x}_{t})\mathbf{h}\left( s^{t}\right) =0.
\end{equation*}%
Substitute this into (\ref{Tech appendix: gain from h}) to show that $%
\mathbf{h}$ does not improve utility of consumer.
\end{proof}


\subsection{Proof of Theorem \protect\ref{thm: rep agent general theorem}}


\begin{proof}
The optimal Ramsey plan solves the following Bellman equation. Let $V(b\_)$ be the maximum ex-ante value the government can achieve with debt $b\_$. 

\begin{equation}
  \label{eq-QLRA obj}
    V(b\_)=\max_{c(s),l(s),b(s)} \sum_{s}\pi(s)\left\{c(s)-\frac{l(s)^{1+\gamma}}{1+\gamma}+\beta V(b(s)) \right\}
\end{equation}   
subject to

   \begin{subequations}
   \label{sys- QLRA constraint}
    \begin{equation}
    \label{rep agent implementability constraint }
    c(s)+b(s)=l(s)^{1+\gamma}+\beta^{-1} P(s)b\_
    \end{equation}
 

 
\begin{equation}
  \label{eq-resoruces}
c(s)+g(s)\leq\theta l(s)
\end{equation}   
Let $\bar{b}=-\underline{B}$
\begin{equation}
  \label{ndl}
\underline{b}\leq b(s)\leq \bar{b}
\end{equation}   


   \end{subequations}
%Let $\mu(s)\pi(s),\phi(s)\pi(s)$ be the Lagrange multipliers on the respective constraints. 

{Part 1 of Theorem \textbf{\ref{thm: rep agent general theorem}}}

\begin{lemma}
There exists  a $\overline{b}$ such that $b_t\leq\overline{b}$. This is the natural debt limit for the government.
\end{lemma}
\begin{proof}
As we drive $\mu$ to $-\infty$, the tax rate approaches a maximum limit, $\bar{\tau}=\frac{\gamma}{1+\gamma}$. In state $s$, the government surplus,
\[
  S(s,\tau) = \theta^\frac\gamma{1+\gamma}(1-\tau)^\frac1\gamma\tau - g(s),
\]  which  is  maximized at $\tau = \frac\gamma{1+\gamma}$ when $(1-\tau)^\frac1\gamma\tau$ is also maximized. This would impose a natural borrowing limit for the government. 

\end{proof}

From now we assume that $\overline{b}$ represents the natural borrowing limit. We begin with some useful lemmas

let $L\equiv l^{1+\gamma }.$, To make this problem convex, 

Substitute for $c\left( s\right) $%
\[
V\left( b\_\right) =\max_{L(s),b(s)}\sum_{s\in S}\pi \left(
s\right) \left[ \frac{1}{1+\gamma }L\left( s\right) +\frac{1}{\beta }%
P\left( s\right) b\_-b\left( s\right) +\beta V\left( b\left( s\right)
\right) \right] 
\]%
s.t.%
\begin{eqnarray*}
\frac{1}{\beta }P\left( s\right) b-b\left( s\right) +g\left( s\right) &\leq
&\theta L^{\frac{1}{1+\gamma} }\left( s\right) -L\left( s\right) \\
b\left( s\right) &\leq &\bar{b} \\
L\left( s\right) &\geq &0.
\end{eqnarray*}

\begin{lemma}
\smallskip $V\left( b\right) $ is stictly concave, continuous,
differentiable and $V\left( b\right) <\beta ^{-1}$ for all $%
b<\bar{b}.$ The feasibility constraint binds for all $b\in (-\infty ,\bar{b}%
],\ s\in S$ and $\left( L^{\ast }\left( s\right) \right) ^{1-\frac{1}{1+\gamma} }\geq
\frac{1}{1+\gamma} .\footnote{
This last condition simply means that we do not tax to the right of the peak
of the Laffer curve. The revenue maximizing tax is $1-\bar{\tau}=\frac{1}{%
1+\gamma }.$ At the same time $1-\tau =l^{\gamma}$ so if taxes are always
to the left of the peak, $\frac{1}{1+\gamma }\leq l^{\gamma }=\left(
L^{\frac{1}{1+\gamma} }\right) ^{\gamma}=L^{1-\frac{1}{1+\gamma} }$.}$ 
\end{lemma}

\begin{proof}
\smallskip \textit{Concavity}

$V\left( b\right) $ is concave because we maximize linear objective
function over convex set.

\textit{Binding feasibility}

Suppose that feasibility does not bind for some $b,s.$ Then the optimal $%
L\left( s\right) $ solve $\max_{L\left( s\right) \geq 0}\pi \left( s\right) 
\frac{\gamma}{1+\gamma }L\left( s\right) $ which sets $L\left( s\right)
=\infty .$ This violates feasility for any finite $b,b\left( s\right) .$

\textit{Bounds on }$L$

Let $\phi\left( s\right) >0$ be a Lagrange multiplier on the
feasibility. \ The FOC for $L\left( s\right) $ is 
\[
\frac{1}{1+\gamma }+\phi(s) \left( \frac{1}{1+\gamma }L(s)^{\frac{1}{1+\gamma}
-}-\theta \right) =0. 
\]%
This gives%
\[
\frac{1}{1+\gamma }L^{\frac{1}{1+\gamma} -1}-\theta =-\frac{1}{\lambda }\frac{\gamma}{%
1+\gamma }<0 
\]%
or%
\[
L^{1-\frac{1}{1+\gamma} }\geq \frac{\theta }{1+\gamma }. 
\]

\textit{Continuity}

For any $L$ that satisfy $L^{1-\frac{}{1+\gamma} }\geq \frac{\theta }{1+\gamma} ,$ define function $%
\Psi $ that satisfies $\Psi \left( L^{\frac{1}{1+\gamma} }-\theta L\right) =L.$ Since $%
L^{\frac{1}{1+\gamma} }-L$ is strictly decreasing in $L$ for $L^{1-\frac{1}{1+\gamma} }\geq
\frac{1}{1+\gamma} $, this function is well defined. Note that $\Psi \left(
{}\right) \underbrace{\left( \frac{1}{1+\gamma }L^{\frac{1}{1+\gamma} -1}-\theta \right) }%
_{<0}=1$ (so that $\Psi >0$, i.e. $\Psi $ is strictly decreasing)
and $\Psi ^{\prime \prime }\underbrace{\left( \frac{1}{1+\gamma }L^{\frac{1}{1+\gamma}
-1}-1\right) ^{2}}_{>0}+\underbrace{\Psi }_{<0}\underbrace{\frac{1%
}{1+\gamma }\frac{\gamma }{1+\gamma }L^{\frac{1}{1+\gamma} -2}}_{<0}=0$ (so that $\Psi
^{\prime \prime }\geq 0$, $\Psi ^{\prime \prime }>0,$ i.e. $\Psi $ is
strictly concave on the interior). $\Psi $ is also continuous. When $%
L^{1-\frac{1}{1+\gamma} }=\frac{1}{1+\gamma} ,$ $L=(1+\gamma) ^{-\frac{(1+\gamma)} {\left( \gamma \right)} }.$
Let $D\equiv (1+\gamma) ^{\frac{-1}{ \gamma }-(1+\gamma) ^{-\frac{1+\gamma }{\left(\gamma\right)} }}.$ Then the objective is 
\[
V\left( b\_\right) =\max_{b\left( s\right) }\sum_{s\in S}\pi \left(
s\right) \left[ \Psi \left( \frac{1}{\beta }P\left( s\right) b-b\left(
s\right) +g\left( s\right) \right) +\frac{1}{\beta }P\left( s\right)
b\_-b\left( s\right) +\beta V\left( b\left( s\right) \right) \right] 
\]%
s.t.%
\begin{eqnarray*}
b\left( s\right) &\leq &\bar{b} \\
\frac{1}{\beta }P\left( s\right) b\_-b\left( s\right) +g\left( s\right) &\leq
&D.
\end{eqnarray*}

This function is continuous so $V$ is also continuous.

\textit{Differentiability}

Continuity and convexity implies differentiability everywhere, including the
boundaries.

\textit{Strict concavity}

$\Psi $ is strictly concave, so on the interior $V$ is strictly
concave.

\end{proof}

\smallskip Next we characterize policy functions

\begin{lemma}
\label{lem increasing b}
$b\left( b\_,s\right) $ is an increasing function of $b$ for all $s$ for all $%
\left( b\_,s\right) $ where $b\left( s\right) $ is interior.
\end{lemma}

\begin{proof}
Take the FOCs for $b\left( s\right) $ from the condition in the previous
problem. If $b\left( s\right) $ is interior%
\[
\Psi \left( \frac{1}{\beta }P\left( s\right) b\_-b\left( s\right)
+g\left( s\right) \right) =\beta V\left( b\left( s\right)
\right) . 
\]

Suppose $b_{1}<b_{2}$ but $b_{2}\left( s\right) <b_{1}\left( s\right) .$
Then from stict concavity%
\begin{eqnarray*}
V\left( b_{2}\left( s\right) \right) &<&V^{\prime
}\left( b_{1}\left( s\right) \right) \\
\Psi \left( \frac{1}{\beta }P\left( s\right) b_{2}-b_{2}\left(
s\right) +g\left( s\right) \right) &>&\Psi \left( \frac{1}{\beta }%
P\left( s\right) b_{1}-b_{1}\left( s\right) +g\left( s\right) \right) .
\end{eqnarray*}
\end{proof}

\begin{lemma}
There exists an invariant distribution of the stochastic process $b_{t+1}=b(s_{t+1},b_t)$ 
\end{lemma}
\begin{proof}
The state spaces for $b_t$ and $s_t$ are compact. Further the transition function on $s_{t+1}|s_{t}$ is trivially increasing under i.i.d shocks. We can apply standard arguments as in \cite{Prescott1992}(see corollary 3) to argue that there exists invariant distribution of assets.  
\end{proof}

Now we characterize the support of this distribution using further properties of the policy rules for $b(s|b\_)$


\begin{lemma}
\label{prop: b(s) relative to b}For any $b\_\in (\underline{b} ,\bar{b}),$ there are $s,s^{\prime \prime }$ s.t. $b\left( s\right) \geq b\_\geq b\left( s^{\prime \prime }\right) .$ Moreover, if there are any states $s^{\prime \prime },s^{\prime \prime \prime }$ s.t. $b\left( s^{\prime \prime
}\right) \neq b\left( s^{\prime \prime \prime }\right) ,$ those inequalities
are strict.
\end{lemma}


\begin{proof}
The FOCs together with the envelope theorem imply that $\mathbb{E}P(s)V'(b(s))=V'(b\_)+\kappa(s)$
We can rewrite this as $\mathbb{\tilde{E}}V'(b(s))=b+\kappa(s)$ with $\tilde{\pi}(s)=P(s)\pi(s)$

Now if there is at least one $b\left( s\right) $ s.t. $b\left(
s\right) >b\_,$ by strict concavity of $V$ there must be some $%
s^{\prime \prime }$ s.t. $b\left( s^{\prime \prime }\right) <b.$

If there is at least one $b\left( s\right) $ s.t. $b\left(
s\right) <b\_,$ the inequality above is strictly only if $b\left(
s^{\prime \prime \prime }\right) =\bar{b}$ for some $s^{\prime \prime \prime
}.$ But $V\left( \bar{b}\right) <V\left(
b\right) $ so there must be some $s^{\prime \prime }$ s.t. $b\left(
s^{\prime \prime }\right) >b.$ Equality is possible only if $b\_=b\left(
s\right) $ for all $s.$
\end{proof}


\begin{lemma}  Let $\mu(b,s)$ be the optimal policy function for the Lagrange multiplier $\mu(s)$.  If $P(s') > P(s'')$ then there exists a $b^*_{s',s''}$ such that for all $b < (>) \; b_{1,s',s''}$ we have $\mu(b,s') > (<) \;\mu(b,s'')$.  If $\underline b < b^*_{s',s''} < \overline b$ then $\mu(b^*_{s',s''},s') = \mu(b^*_{s',s''},s'')$.
\label{lem.order}
\end{lemma}
\begin{proof} 
Suppose that $\mu(b,s')\leq \mu(b,s'')$.  Subtracting the implementability for $s''$ from the implementability constraint for $s'$ we have 
\begin{align*}
	\frac{P(s')-P(s'')}{\beta}b &= S_{s'}(\mu(b,s'))-S_{s''}(\mu(b,s'')) + b'(b,s')-b'(b,s'')\\
						&\geq S_{s'}(\mu(b,s')) -S_{s''}(\mu(b,s')) + b'(b,s')-b'(b,s'')\\
						&\geq  S_{s'}(\mu(b,s')) -S_{s''}(\mu(b,s')) = g(s'')-g(s')
\end{align*}  We get the first inequality from noting that $S_s(\mu')\geq S_s(\mu'')$ if $\mu' \leq \mu''$.  We obtain the second inequality by noting that $\mu(b,s')\leq \mu(b,s'')$ implies $b'(b,s')\geq b'(b,s'')$ (which comes directly from the concavity of $V$).
Thus, $\mu(b,s')\leq \mu(b,s'')$ implies that 
\begin{equation}
\label{pair-wise ss}
b \geq \frac{\beta(g(s'')-g(s'))}{P(s')-P(s'')} = b^*_{s',s''} 
\end{equation}

The converse of this statement is that if $b<b^*_{s',s''}$ then $\mu(b,s') > \mu(b,s'')$.  The reverse statement that $\mu(b,s') \geq \mu(b,s'')$ implies $b \leq b^*_{s,s'}$ follows by symmetry.   Again, the converse implies that if $b > b^*_{s',s''}$ then $\mu(b,s') < \mu(b,s'')$.    Finally, if $\underline b < b^*_{s',s''} <\overline b$ then continuity of the policy functions implies that there must exist a root of $\mu(b,s')-\mu(b,s'')$ and that root can only be at $b^*_{s',s''}$.
\end{proof}


\begin{lemma}
\label{lem: existence and uniqueness of ss}
$P \in \mathcal{P}^*$ is necessary and sufficient for existence of $b^*$ such that $b(s,b^*)=b*$ for all $s$s
\end{lemma}

\begin{proof}
The necessary part follows from taking differences of the \eqref{rep agent implementability constraint } for $s'$,$s''$. We have 
\[[P(s)-P(s'')]\frac{b^*}{\beta}=g(s)-g(s'')\]
Thus $P\in\mathcal{P}^*$. The sufficient part follows from the Lemma \ref{lem.order}. If $P \not \in \mathcal{P}^*$, equation \ref{pair-wise ss} that defines $b^*_{s',s''}$ will not be same across all pairs. Thus $b^*$ that satisfies $b(s;b^*)$ independent of $s$ will not exist.
\end{proof}


Lemma  \ref{lem: existence and uniqueness of ss}  implies that under the hypothesis of part 1 of the Theorem \ref{thm: rep agent general theorem} there cannot exist an interior absorbing point for the dynamics of debt. This allows us to construct a sequences $\{b_t\}_t $ such that $b_t<b_{t+1}$ with the property that $\lim_tb_t=\underline{b}$.
Thus, for any $\epsilon>0$, there exists a finite history of shocks that can take us arbitrarily close to $\underline{b}$. Since the shocks are i.i.d this finite sequence will repeat i.o. With a symmetric argument we can show that $b_t$ will come arbitrarily close to its upper limit i.o too





{Part 2 of Theorem \textbf{\ref{thm: rep agent general theorem}}}


In this first section we will show that there exists $b_1$, and if $p$ is sufficiently volatile a $b_2$, such that if $b_t\leq b_1$ then 
\[
	\mu_t \geq \EE_t \mu_{t+1}
\] and if $b_t \geq b_2$ then
\[
	\mu_t \leq \EE_t \mu_{t+1}.
\]  Recall that $b$ is decreasing in $\mu$, so this implies that if $b_t$ is low (large) enough then there will exist a drift away from the lower (upper) limit of government debt.

With Lemma \ref{lem.order} we can order the policy functions $\mu(b,\cdot)$ for particular regions of the state space.  Take $b_1$ to be
\[
	b_1 = \min\left\{b^*_{s',s''}\right\}
\] and WLOG choose $\underline b < b_1$.  For all $b < b_1$ we have shown that $P(s) > P(s')$ implies that $\mu(b,s) > \mu(b,s')$.  The FOC for the problem imply,

\begin{equation}\label{eq.mart}
	\mu_t = \EE_t p_{t+1}\mu_{t+1}+\underline{\kappa}_t
\end{equation}  The inequality in the resource constraint implies that $\xi(s)\geq 0$ implying that $\mu(s) \leq 1$.  With some minor algebra algebra we obtain

By decomposing $\EE \mu_{t+1}p_{t+1}$ in equation \eqref{eq.mart}, we obtain (using $\EE_t p_{t+1} = 1$)
\begin{equation}
	\mu_t = \EE\mu_{t+1} +\cov_t(\mu_{t+1},p_{t+1}) + \kappa_t
\end{equation}Our analysis has just shown that for $b_t < b_1$ we have $\cov_t (\mu_{t+1},p_{t+1})  >0$ so 
\[
	\mu_t > \EE_t\mu_{t+1}.
\]  If $p$ is sufficiently volatile:
\[
	P(s') - P{s''} > \frac{\beta(g_{s''}-g_{s'})}{\overline b}
\] then 
\[
	b_2 = \max\left\{b^*_{s',s''}\right\} <\overline b
\] and through a similar argument  we can conclude that $\cov_t(\mu_{t+1},p_{t+1}) < 0$ 
\[
	\mu_t < \EE_t \mu_{t+1}
\] for $b_t > b_2$ (note $b_t >\underline b$ implies $\kappa_t =0$) which gives us a drift away from the upper-bound. 


{Part 3 of Theorem \textbf{\ref{thm: rep agent general theorem}}}


When $P\in\mathcal{P}^*$, Lemma \ref{lem: existence and uniqueness of ss} implies existence of $b^*$ as the steady state debt level.
\begin{lemma}
\label{sub super martingale}
There exists $\mu^*$ such that $\mu_t$  is a sub-martingale bounded above in the region $(-\infty,\mu^*)$ and super-martingale bounded below in the region $(\mu^*,\frac{1}{1+\gamma})$


\end{lemma}
\begin{proof}
Let $\mu^*$ be the associated multiplier, i.e $V_b(b^*)=\mu^*$.  Using the results of the previous section, we have that $b_1 = b_2 = b^*$, implying that $\mu_t < (>) \EE_t\mu_{t+1}$ for $b_t  < (>) b^*$. 
\end{proof}

Lastly we show that $\lim_t \mu_t=\mu^*$. Suppose $b_{t}<b^*$, we know that $\mu_t>\mu^*$. The previous lemma implies that in this region, $\mu_t$ is a super martingale. The lemma $\ref{lem increasing b}$ shows that $b(b\_,s)$ is continuous and increasing. This translates into $\mu(\mu(b\_),s)$ to be continuous and increasing as well.
 Thus 
 \[\mu_{t}>\mu^* \implies \mu(\mu_{t},s_{t+1})>\mu(\mu^*,s_{t+1}) \]
or
 \[\mu_{t+1}>\mu^*\]
Thus $\mu*$  provides a lower bound to this super martingale. Using standard martingale convergence theorem converges. The uniqueness of steady state implies that it can only converge to $\mu^*$. For $\mu<\mu^*$, the argument is symmetric.


\end{proof}

\newpage

\subsection{Proof of Theorem \protect\ref{thm: rep agent linear policies}}

Working with the first order conditions of problem \ref{eq-QLRA obj}, we obtain
\[
	l(s)^\gamma = \frac{\mu(s)-1}{(1+\gamma)\mu(s) - 1} = 1-\tau(\mu(s)),
\]
implying the relationship between tax rate $\tau$ and multiplier $\mu$ given by

\begin{equation}\label{eq.tau}
	\tau(\mu) = \frac{\gamma\mu}{(1+\gamma)\mu-1}
\end{equation}

The rest of the first order conditions  are summarized below
\begin{align*}
	\frac{b\_ P(s)}{\beta }= S(\mu(s),s) + b(s)\\
	V'(b) = \EE P(s) \mu(s)\\
	\mu(s) = V'(b(s))
\end{align*} 



where $S(\mu,s)$ is the government surplus in state $s$ given by
\[
	S(\mu,s) = (1-\tau(\mu))^\frac1\gamma \tau(\mu)-g(s) = I(\mu) - g(s)
\]


The proof of the theorem will have four steps:

\textbf{Step 1:} Obtaining a recursive representation of the optimal allocation in the incomplete markets economy with payoffs $P(s)$ with state variable $\mu\_$


Given a pair $\{P(s),g(s)\}$, since $V'(b)$ is one-to-one, so we can re-characterize these equations as searching for a function $b(\mu)$ and $\mu(s|\mu\_)$such that the following two equations can be solved for all $\mu\_$.
\begin{align}\label{eq.lin_imp}
	\frac{b(\mu\_)P(s)}{\beta } = I(\mu(s)) - g(s) +b(\mu(s))\\
	\mu = \EE\mu(s)P(s)\label{eq.lin_mart}
\end{align}  



\textbf{Step 2:} Describe how the policy rules are approximated

Usually perturbation approaches  to solve equilibrium conditions as above look for the solutions to $\{\mu(s|\mu\_)\}$ and $b(\mu\_)$ around deterministic steady state of the model. Thus for any $b^{ss}$, there exists a $\mu^{ss}$ that will solve

\[	\frac{b^{SS}}{\beta } = I(\mu^{SS}) - \bar{g} +b^{SS}\\
\]


For example if we set the perturbation parameter $q$ to scale the shocks, $g(s)=\mathbb{E}g(s)+q\Delta_g(s)$ and $P(s)=1+q\Delta_{P}(s)$, the first order expansion of $\mu(s|\mu\_)$ will imply that it is a martingale. Such approximations are not informative about the ergodic distribution. \footnote{One can do higher order approximations, but part 3 of theorem \ref{thm: rep agent general theorem} hints that for economies with payoffs close to $\mathcal{P}^*$, the stochastic steady state in general is far away from $\mu^{SS}$.}



In contrast we will approximate the functions $\mu(s|\mu\_)$ around 
around economy with payoffs in $\bar{P}\in \mathcal{P}^*$. 

In contrast we a) explicitly recognize that policy rules depend on payoffs: $\mu(s|\mu\_,\{P(s)\}_s)$ and $b(\mu\_,\{P(s)\}_s)$ and then take take the first order expansion with respect to both $\mu\_$ and $\{P(s)\}$ around the vector $(\bar{\mu},\{\bar{P}(s)\}_s)$ where $\bar{P}(s) \in \mathcal{P}^*$: these payoffs support  an allocation such that limiting distribution of debt is degenerate around the some value $\bar{b}$; and  $\overline {\mu}$ is the corresponding limiting value of multiplier. The next two expression make the link between $\bar{\mu}$ and $\bar{b}$ explicit. 
\begin{subequations}
\label{eq.ss.} 
\begin{equation}
\overline b = \frac{\beta}{1-\beta}\left( I(\overline\mu) - \overline g\right) 
\end{equation}
where $\overline g = \EE g$ and $\overline p$ as 
\begin{equation}
	\overline P(s) = 1+ \frac\beta{\overline b}(g(s) - \overline g) 
\end{equation}
\end{subequations}

As noted before $b(\overline\mu;\overline p) = \overline b$ solves the the system of equations (\ref{eq.lin_imp}-\ref{eq.lin_mart}) for $\mu'(s) = \overline \mu$ when the payoffs are $\overline{P}(s)$ 

We next obtain the expressions that characterize the linear approximation of $\mu(s|\mu\_,\{P(s)\})$ and $\b(\mu\_,\{P(s)\})$ around some arbitrary point $(\bar{\mu},\{\bar{P}(s)\}_s)$ where $\bar{P}(s) \in \mathcal{P}^*$. We will use these expressions to compute the mean and variance of the ergodic distribution associated with the approximated policy rules. Finally as a last step we propose a particular choice of the point of approximation.

The derivatives $\frac{\delta \mu(s|\mu\_,\{P(s)\}}{\delta \mu\_}$,$\frac{\delta \mu(s|\mu\_,\{P(s)\}}{\delta P(s)}$ and similarly for  $b(\mu\_,\{P(s)\}$ are obtained below:


Differentiating equation \eqref{eq.lin_imp} with respect to $\mu$ around $(\overline \mu,\overline P)$ we obtain
\[
	\frac{\overline{P}(s)}{\beta}\frac{\partial b}{\partial \mu\_} = \left[I'(\mubar)+\frac{\partial b}{\partial \mu\_}\right]\frac{\partial \mu(s)}{\partial \mu\_}.
\]Differentiating equation \eqref{eq.lin_mart} with respect to $\mu\_$ we obtain
\[
	1 = \sum_{s} \pi(s) \overline P(s) \frac{\partial \mu'(s)}{\partial \mu\_}
\]combining these two equations we see that 
\[
	\frac1\beta\left(\sum_s\pi(s)\overline P(s)^2\right)\frac{\partial b}{\partial \mu\_} = I'(\mubar) + \frac{\partial b}{\partial \mu\_}
\]Noting that $\EE\overline P^2(s) = 1 + \frac{\beta^2}{\bbar^2}\sigma^2_g$ we obtain
\begin{equation}
	\frac{\partial b}{\partial \mu\_} = \frac{I'(\mubar)}{\frac{\beta}{\bbar^2}\sigma_g^2 +\frac{1-\beta}{\beta}} < 0
\end{equation}as $I'(\mubar) < 0$.  We then have directly that 
\begin{equation}
	\frac{\partial \mu'(s)}{\partial \mu} = \frac{\overline P(s)}{\frac{\beta^2}{\overline b^2}\sigma^2_g +1} = \frac{\overline P(s)}{\EE\overline P(s)^2}
\end{equation}  We can perform the same procedure for $P(s)$.  Differentiating equation \eqref{eq.lin_imp} with respect to $P(s)$ we around $(\mubar,\pbar)$ we obtain
\begin{equation}\label{eq.dimp_dps}
\frac{\pbar(s')}{\beta}\frac{\partial b}{\partial P(s)} + 1_{s,s'}\frac{\bbar}{\beta} - \frac{\pi(s)\bbar\pbar(s')}{\beta} = \left[I'(\mubar) + \frac{\partial b}{\partial \mu}\right]\frac{\partial \mu(s')}{\partial P(s)}
\end{equation} Here $1_{s,s'}$ is $1$ if $s = s'$ and zero otherwise.  Differentiating equation \eqref{eq.lin_mart} with respect to $P(s)$ we obtain
\[
	0 = \pi(s)\overline \mu - \pi(s)\overline \mu + \sum_{s'} \pi(s) \pbar(s')\frac{\partial \mu(s')}{\partial P(s)} =  \sum_{s'} \pi(s')\pbar(s')\frac{\partial \mu(s')}{\partial P(s)}
\]  Again we can combine these two equations to give us
\[
	\frac{\EE\pbar(s)^2}{\beta}\frac{\partial b}{\partial P(s)} + \frac{\pi(s)\bbar}{\beta}(\pbar(s)-\EE\pbar(s)^2) = 0
\] or
\begin{equation}
	\frac{\partial b}{\partial P(s)} = \pi(s)\bbar \frac{\EE\pbar^2-\pbar(s)}{\EE\pbar^2}
\end{equation}Going back to equation \eqref{eq.dimp_dps} we have
\begin{equation}
	\frac{\partial \mu(s')}{\partial P(s)} = \frac{\bbar}{\beta\left[I '(\mubar) + \frac{\partial b}{\partial \mu}\right]}\left(1_{s,s'}-\frac{\pi(s)\pbar(s)\pbar(s')}{\EE\pbar^2}\right)
\end{equation}


\textbf{Step 3:} Getting expressions for the mean and variance of the ergodic distribution around some arbitrary point of approximation

For an arbitrary $\left (\overline \mu,\{\overline {P}(s )\}_{s}\right)$, using the derivatives that we computed, we can characterize the dynamics of $\hat{\mu}\equiv\mu_t-\mubar$ using our approximated policies.


\[
	\hat \mu_{t+1} = B \hat\mu_t + C,
\]  where $B(s)$ and $C(s)$ are respective derivatives. Note that both are random variables and let us denote their means $\barB$ and $\barC$, and variances $\sigma_B^2$ and $\sigma_C^2$ .  Suppose that $\hat\mu$ is distributed according to the ergodic distribution of this linear system with mean $\EE\hat\mu$ and variance $\sigma^2_\mu$.  Since 
\[
	B\hat\mu +C,
\]has the same distribution we can compute the mean of this distribution as
\[
\begin{split}
	\EE\hat\mu &= \EE\left[ B\hat\mu+C\right]\\
			  &= \EE\left[\EE_{\hat\mu}\left[B\hat\mu+C\right]\right]\\
			  &= \EE\left[\barB\hat\mu +\barC\right]\\
			  &=\barB\EE\hat\mu+\barC
\end{split}
\]solving for $\EE\hat\mu$ we get
\begin{equation}
	\EE\hat\mu = \frac{\barC}{1-\barB}
\end{equation}For the variance $\sigma^2_{\hat\mu}$ we know that 
\[
	\sigma^2_{\hat\mu} = \var(B\hat\mu+C) = \var(B\hat\mu) + \sigma_C^2 + 2\cov(B\hat\mu,C)
\]Computing the variance of $B\hat \mu$ we have
\[
\begin{split}
	\var(B\hat\mu) &=\EE\left[(B\hat\mu - \barB\EE\hat\mu)^2\right]\\
			       &=\EE\left[(B\hat\mu-\barB\hat\mu +\barB\hat\mu -\barB\EE\hat\mu)^2\right]\\
			      &=\EE\left[\EE_{\hat\mu}\left[(B-\barB)^2\hat\mu^2 +2(B-\barB)(\hat\mu-\EE\hat\mu)\barB\EE\hat\mu + (\hat\mu-\EE\hat\mu)^2\bar B^2\right]\right]\\
			&=\EE\left[\sigma_B^2\hat\mu^2 +(\hat\mu-\EE\hat\mu)^2\barB\right]\\
			& = \sigma_B^2(\sigma_{\hat\mu}^2+(\EE\hat\mu)^2) + \sigma_{\hat\mu}^2\barB^2
\end{split}
\]while for the covariance of $B\hat\mu$ and $C$
\[
	\cov(B\hat\mu,C) = \sigma_{BC}\EE\hat\mu
\]Putting this all together we have
\begin{equation}
	\sigma_{\hat\mu}^2 = \frac{\sigma_B^2(\EE\hat\mu)^2 + \sigma_{BC}\EE\hat\mu + \sigma_C^2}{1-\barB^2-\sigma_B^2}
\end{equation}


\textbf{Step 4:} Choice of the point of approximation

To get the expressions in Theorem \ref{thm: rep agent general theorem}, we finally choose a particular $\overline{P}=P^*(s) \in \mathcal{P}^*$. This will be the closest complete market economy to our the given $P(s)$ in $L^2$ sense. Formally,

\[
\min_{\tilde{P}\in \mathcal{P}^*} \sum_{s}\pi(s)( P(s)-\tilde{P}(s))^2.
\]
Since all payoffs in $\mathcal{P}^*$ are associated with some $b^*$ and $\mu^*$ via equations \eqref{eq.ss.},  we can re write the above problem as choosing $\mubar$ so as to minimize the variance of the difference between $ P(s)$ and the set of steady state payoffs.  Let $P^*$ be the solution to this minimization problem. The first order condition for this linearization gives us 
\[
	2\sum_{s'}\pi( P(s')-P^*(s',\mu^*)) \frac{\delta P^*(s,\mu^*)}{\delta \mu^*} = 0
\]as noted before 
\[
	P^*(s) =  1 -\frac{\beta}{b^*(\mu^*)}\left(g(s) - \EE g\right)
\]thus
\[
\frac{\delta P^*}{\delta \mu^*}\propto P^*-1
\]Thus we can see the the optimal choice of $\mubar$ is equivalent to choosing $\mubar$ such that 
\begin{equation}
	\begin{split}
		0 &= \sum_{s'}\Pi_{s'}( P(s') - P^*(s',\mu^*))(P^*(s',\mu^*)-1)\\
		&= -\sum_{s'}\Pi_{s'}( P(s')-P^*(s',\mu^*)) + \sum_{s'}\Pi_{s'}( P(s')-P^*(s',\mu^*))P^*(s',\mu^*)\\
		&= \sum_{s'}\Pi_{s'}( P(s')-P^*(s',\mu^*))P^*(s',\mu^*)\\
		&=\EE\left[( P-P^*)P^*\right]
	\end{split}
\end{equation}  At these values of $\pbar=P^*$ and $\mubar=\mu^*$ we have that $C$ for our linearized system is

\[
	C(s') = \sum_s\left\{\frac{{b^{*}}}{\beta\left[I'(\mubar)+\frac{\partial b}{\partial\mu}\right]}\left(1_{s,s'}-\frac{\pi(s) P^*(s)P^*(s')}{\EE\pbar^2}\right)(P(s)-P^*(s)) \right\}
\]Taking expectations we have that 
\begin{equation}
\begin{split}
	\barC &= \sum_s\left\{\frac{{b^{*}}}{\beta\left[I'(\mubar)+\frac{\partial b}{\partial\mu}\right]}\left(\pi(s) - \frac{\pi(s)P^*(s)}{\EE\pbar^2}\right)( P(s)-P^*(s))\right\}\\
	&=\frac{{b^{*}}}{\beta\left[I'(\mubar)+\frac{\partial b}{\partial\mu}\right]}\left(\EE( P-\pbar) -\frac{\EE\left[( P-\pbar)\pbar\right]}{\EE\pbar^2}\right)\\
	&= 0 
\end{split}
\end{equation}  Thus the linearized system will have the same mean for $\mu$, $\mubar$, as the closest approximating steady state payoff structure.

We can also compute the variance of the ergodic distribution for $\mu$.  Note 
\[
\begin{split}
	C(s') &= \sum_s\left\{\frac{{b^{*}}}{\beta\left[I'(\mubar)+\frac{\partial b}{\partial\mu}\right]}\left(1_{s,s'}-\frac{\pi(s) P^*(s)P^*(s')}{\EE{P^*}^2}\right)(P(s)-P^*(s)) \right\}\\
		 &=\frac{{b^{*}}}{\beta\left[I'(\mubar)+\frac{\partial b}{\partial\mu}\right]}\left( P(s')-P^*(s') -P^*(s')\frac{\sum_s\pi(s)P^*(s)( p_s-P^*(s))}{\EE{P^*}^2}\right)\\
		&= \frac{{b^{*}}}{\beta\left[I'(\mubar)+\frac{\partial b}{\partial\mu}\right]}( P(s')-P^*(s))
\end{split}
\]  As noted before
\[
	\sigma_{\mu}^2 = \frac{{b^{*}}^ 2}{\beta^2\left[I'(\mubar)+\frac{\partial b}{\partial\mu}\right]^2\left(1-\barB^2-\sigma_B^2\right)}\| P-{P^*}\|^2
\]  The variance of government debt in the linearized system is 
\[
	\sigma_b^2 = \frac{{b^{*}}^2\left(\frac{\partial b}{\partial\mu}\right)^2}{\beta^2\left[I'(\mubar)+\frac{\partial b}{\partial\mu}\right]^2\left(1-\barB^2-\sigma_B^2\right)}\| P-{P^*}\|^2
\]  This can be simplified using the following expressions: 
\[
	I'(\mubar)+\frac{\partial b}{\partial \mu} = \frac{\EE{P^*}^2}{\beta}\frac{\partial b}{\partial\mu},
\]
\[
	\barB = \frac{1}{\EE{P^*}^2}
\]and
\[
	\sigma_B^2 = \frac{\var({P^*})}{(\EE{P^*}^2)^2}
\] to
\begin{equation}
	\sigma^2_b = \frac{{b^{*}}^2}{\EE{P^*}^2\var({P^*})}\|P-{P^*}\|^2
\end{equation}Noting that $\EE{P^*}^2 = 1 +\var({P^*}) > 1$, we have immediately that up to first order the relative spread of debt is bounded by
\begin{equation}
	\frac{\sigma_b}{{b^{*}}} \leq \sqrt\frac{\|P-{P^*}\|^2}{\var({P^*})}
\end{equation}  


\newpage





\newpage

\subsection{Proof of Theorem \protect\ref{thm heterogeneous agents}}
\begin{proof}
 
Using Theorem \ref{theorem: main} let $\tilde{b}=b_1-b_2$. Under the normalization that $b_2=0$, the variable $\tilde{b}$ represents public debt government or the assets of the productive agent. Specializing the formulations in section \ref{} we have the optimal plan solves the following Bellman equation.

\begin{equation}
	\label{eq-2 agent QL obj}
   	V(\tilde{b}\_)=\max_{c_1(s),c_2(s),b'(s)} \sum_{s}\pi(s)\left\{\omega\left[u(c_1(s),l_1(s))\right]+(1-\omega)\left[c_2(s)\right]+\beta V(\tilde{b}(s)) \right\}
\end{equation}   
subject to

   \begin{subequations}
   \label{sys-2 agent QL constraint}
   	\begin{equation}
   	\label{eq-implementability constraint}
   	c_1(s)-c_2(s)+\tilde{b}(s)=l(s)^{1+\gamma}+\beta^{-1} P(s)\tilde{b}\_
   	\end{equation}

 
\begin{equation}
	\label{eq-resoruces}
   	n c_1(s)+(1-n)c_2(s)+g(s)\leq\theta_2 l(s)n
\end{equation}   


\begin{equation}
	\label{eq-non negativity of consumption}
   	c_2(s)\geq0
\end{equation}   

\begin{equation}
	\label{eq-debt limits}
   	\overline{b}\geq\tilde{b}(s)\geq \underline{b}
\end{equation}   
   \end{subequations}

Let $\mu(s),\phi(s),\lambda(s),\underline{\kappa}(s),\overline \kappa(s) $ be the Lagrange multipliers on the respective constraints. The FOC are summarized below

\begin{subequations}
\begin{equation}
\label{eq.het.agent.foc.c1}
\omega-\mu(s) =n \phi(s) 
\end{equation}

\begin{equation}
\label{eq.het.agent.foc.c2}
1-\omega+\mu(s)-\phi(s)(1-n)+\lambda(s)=0
\end{equation}


\begin{equation}
\label{eq.het.agent.foc.l}
-\omega l^\gamma(s)+\mu(s)(1+\gamma)l^{\gamma}(s)+n\phi(s)\theta=0
\end{equation}

\begin{equation}
\label{eq.het.agent.foc.tilde_b}
\beta V'(\tilde{b}(s))-\mu(s)-\overline \kappa(s)+\underline \kappa(s)=0
\end{equation}
and the envelope condition

\begin{equation}
\label{eq.het.agent.foc.envelope}
V'(\tilde{b}\_)=\sum_{s}\pi(s)\mu(s)\beta^{-1}P(s)
\end{equation}

\end{subequations}


To show part 1 of Theorem \ref{thm heterogeneous agents}, we show that $\frac{\omega}{n}>\frac{1+\gamma}{\gamma}$ is sufficient for the Lagrange multiplier $\lambda(s)$ on the non-negativity constraint to bind. 

\begin{lemma} The multiplier on the budget constraint $\mu(s)$ is bounded above
\[\mu(s)\leq \min \left\{\omega-n,\frac{\omega}{1+\gamma}\right\}\]
Similiarly the multiplier of the resource constraint is bounded below,
\[\phi(s)\geq \max \left\{1,\frac{\omega}{n}\left[\frac{\gamma}{1+\gamma}\right]\right\}  \]
\end{lemma}
\begin{proof}

Notice that the labor choice of the productive household implies $\frac{1}{1-\tau}=\frac{\theta_2}{l^{\gamma}(s)}$. 

As taxes go to $-\infty$ \eqref{eq.het.agent.foc.l} implies that $\mu(s)$ approaches $\frac{\omega}{1+\gamma}$ from below. Similiarly the non-negativity of $c_2(s)$ imposes a lower bound of $1$ on $\phi(s)$. This translates into an upper bound of $\omega-n$ on $\mu$. 
\end{proof}



\begin{lemma} 
There exists a $\bar{\omega}$ such that $\omega>\bar{\omega}$ implies $c_2(s)=0$ for all $b$
\end{lemma}
\begin{proof}
 
By the KKT conditions $c_2(s)=0$ if $\lambda(s)>0$. Now \eqref{eq.het.agent.foc.c2} implies this is true if $\mu(s)<\omega-n$.  The previous lemma bounds $\mu(s)$ by $\frac{\omega}{1+\gamma}$. 

We can thus define $\bar{\omega} = n \left(\frac{1+\gamma}{\gamma}\right)$ as the required threshold Pareto weight to ensure that the unproductive agent has zero consumption forever.

\end{proof}




Now for the rest of the parts $\omega<n\frac{1+\gamma}{\gamma}$, we can have postive transfers for low enough public debt. In particular, we can define a maximum level of debt $\mathcal{B}$ that is consistent with an interior solution for the unproductive agents' consumption.

Guess an interior solution $c_{2,t}>0$ or $\lambda_t=0$ for all $t$. This gives us $l(s)=l^*$ defined below:

\begin{equation}
\label{eq.opt.int.labor}
l^*=\left[\frac{n\theta}{\omega-(\omega-n)(1+\gamma)}\right]^{\frac{1}{\gamma}}
\end{equation}
As long as $\omega<n \left(\frac{1+\gamma}{\gamma}\right)$
At the interior solution $\tilde{b}(s)=\tilde b\_$ and using the implementability  constraint and resource constraints \eqref{eq-implementability constraint} and \eqref{eq-resoruces} respectively, we can obtain the expression for $c_{2}(s)$

\[c_{2}(s)=n \theta l^{*}-n {l^*}^{1+\gamma}-\tilde{b}\_(1-P(s)\beta^{-1})-g(s)\]

Non-negativity of $c_2$ implies,


\[\tilde{b}\_\leq \frac{g(s)-n\theta l^*+n{l^*}^{1+\gamma}}{\beta^{-1}P(s)-1}\]


We can also express this as 
\[\tilde{b}\_\leq \frac{g(s)-\tau^*y^* }{\beta^{-1}P(s)-1},\]


where the right hand side of the previous equation is just the present discounted value of the primary deficit of the government at the constant taxes $\tau^*$ associated with $l^*$ defined in \eqref{eq.opt.int.labor}.
As long as $\beta^{-1}P(s)-1>0$, this object is well defined, we define $\mathcal{B}=\min_{s}\left[\frac{g(s)-n\theta l^*+n{l^*}^{1+\gamma}}{\beta^{-1}P(s)-1}\right]$.  Thus for $\tilde{b}\_<\mathcal{B}$ the optimal allocation has constant taxes given by $\tau^*$ and debt $\tilde{b}\_$, while  transfers are given by 

\[T(s)=n \theta l^{*}-n {l^*}^{1+\gamma}-\tilde{b}\_(1-P(s)\beta^{-1})-g(s),\]

and are strictly positive.


For initial debt greater than $\mathcal{B}$, we distinguish cases when payoffs are perfectly aligned with $g(s)$ i.e belong to the set $\mathcal{P}^*$ and when they are not. For part 2 case b, let $P\not \in \mathcal{P}^*$. 

\begin{lemma}
\label{lem.limit.in.one.step}
There exists a $\check b>\mathcal{B}$ such that there are two shocks $\underline{s}$ and $\overline{s}$ and the optimal choice of debt starting from $\tilde{b}\_\leq \check b$ satisfies the following two inequalities:
\[\tilde{b}(\underline s,\tilde{b}\_)>\mathcal{B}\]
\[\tilde{b}(\overline s,\tilde{b}\_)\leq \mathcal{B}\]
\end{lemma}

\begin{proof}
At $\mathcal{B}$, there exist some $\overline s$ such that $T(\overline{s},\mathcal{B})=\epsilon>0$. Now define $\check b$ as follows:

\[\check b =\mathcal{B}	+ \frac{\epsilon \beta }{2 P(\overline{s})}\]

Now suppose to the contrary $\tilde{b}(\overline s, \tilde{b}\_)>\mathcal{B}$ for some $\tilde{b}\_\leq \check b$. This implies that $\tau(s,\tilde b\_)>\tau^*$ and $T(\overline{s}, \tilde b\_)=0$.\footnote{Explain why}

The government budget constraint implies


\[\frac{P(\overline s)\tilde b\_}{\beta}+g(s)=\tilde{b}(\overline s,\tilde{b}\_)+(1-\tau(\overline s, \tilde{b})\_)l(\overline s, \tilde{b}\_).\]


As,
\[\frac{P(\overline s)\tilde{b}\_}{\beta}+g(\overline s)\leq \frac{P(\overline s)\mathcal{B}}{\beta}+g(\overline s)+\frac{\epsilon}{2}< \frac{P(\overline s)\mathcal{B}}{\beta}+g(\overline s)+\epsilon\]

This further implies,
\[\tilde b(\overline s, \tilde b\_)+(1-\tau(\overline s, \tilde b\_))l(\tau(\overline s, \tilde b\_))>	[\tilde b(\overline s, \tilde b\_)+(1-\tau^*)l^*>\mathcal{B}+(1-\tau^*)l^*>\frac{P(\overline s)\tilde{b}\_}{\beta}+g(\overline s)+T(\overline s,\tilde b\_)=\frac{P(\overline s)\tilde{b}\_}{\beta}+g(\overline s)+\epsilon.\]

Combining the previous two inequalities yields a contradiction. The second inequality, $\tilde{b}(\underline s,\tilde{b}\_)>\mathcal{B}$ follows from the definition of $\mathcal{B}$. 


Now define $\overline \mu (\tilde b(s,\tilde{b}\_))$ as $\max_{s} \mu (s,\tilde{b}\_)$ and $\hat{s}(\tilde{b}\_)$ as the shock that achieves this maximum. Now we show that $\hat \mu(\tilde b(s,\tilde{b}\_))$ is finite for all $b\_\leq\overline{b}$. We show the claim for the natural debt limit.


Let $b^{n}(s)=(\beta ^{-1}P(s)-1)^{-1}\left[\theta^{\frac{\gamma}{1+\gamma}}\left(\frac{1}{1+\gamma} \right)^{\frac{1}{\gamma}}\left(\frac{\gamma}{1+\gamma}\right)-g(s)\right]$ be the maximum debt supported by a particular shock $s$. The natural debt limit is defined as $\overline b^{n}=\min_{s}b^{n}(s)$. Note that $\lim_{b\to \overline b^{n}}\mu(\tilde{b}\_)=\infty$

Now choose $s$ such that $b^{n}(s)>\overline b^{n}$ and consider the debt choice next period for the same shock $s$ when it comes in with debt $\overline b^{n}$. 


Suppose it chooses $\tilde{b}(s,\overline {b}^{n})=\overline b^{n}$, then taxes will have to be set to $\frac{\gamma}{1+\gamma}$ and the tax income will be $\frac{\gamma}{1+\gamma}l(\frac{\gamma}{1+\gamma})=\theta^{\frac{\gamma}{1+\gamma}}\left(\frac{1}{1+\gamma}\right)^{\frac{1}{\gamma}}\left(\frac{\gamma}{1+\gamma} \right)$. The budget constraint will then imply that,
\[\frac{\overline  b^{n} P(s)}{\beta}+g(s)=\theta^{\frac{\gamma}{1+\gamma}}\left(\frac{1}{1+\gamma}\right)^{\frac{1}{\gamma}}\left(\frac{\gamma}{1+\gamma} \right)+\overline b^{n}\]
\[\overline b^{n}=(P(s)\beta^{-1}-1)^{-1}\left(\theta^{\frac{\gamma}{1+\gamma}}\left(\frac{1}{1+\gamma}\right)^{\frac{1}{\gamma}}\left(\frac{\gamma}{1+\gamma}\right) -g(s)\right) \]

However the  right hand side is the definition of $b^{n}(s)$ and,

\[b^{n}(s)>\overline b^{n}.\]

Thus we have a contradiction and the optimal choice of debt at the natural debt limit $\tilde{b}(s,\overline {b}^{n})<\overline b^{n}$. 

This inturn means that $\lim_{\tilde b\to \overline b^{n}}\overline \mu (\tilde b) <\infty$. 


Now note that $\overline \mu(\tilde b\_)-\mu(\tilde b\_)$ is continuous on $[\check b, \quad \overline b^{n}]$ and is bounded below by zero, therefore attains a minimum at $\tilde b^{min}$. Let $\delta=\hat \mu(\tilde b^{min})-\mu(\tilde b^{min})>\eta>0$. If this was not true then $P(s)\in \mathcal {P}^*$ as $\mu$ will have an absorbing state. 


Let $\mu(\omega,n)=\omega-n$. This is the value of $\mu$ when debt falls below $\mathcal{B}$. 

Now consider any initial $\tilde b\_ \in [\mathcal{B},\overline b^{n}]$. If $\tilde{b}\_\leq \check b$, then by lemma \ref{lem.limit.in.one.step}, we know that $\mathcal{B}$ will be reached in one shock. Otherwise if $\tilde b\_>\check b$, we can construct a sequence of shocks $s_t=\hat s (\tilde b_{t-1})$ of length $N=\frac{\mu(\omega,n)-\mu(\tilde b\_)}{\delta}$. There exits $t<N$ such that $\tilde b_t<\check b$, otherwise,
\[\mu_t>\mu(\tilde b\_)+N\delta>\mu(\omega,n)\]

Thus we can reach $\mathcal{B}$ in finite steps. Since shocks are i.i.d, this is an almost sure statement. At $\mathcal{B}$, transfers are strictly positive for some shocks $T_t>0$ a.s. and taxes are given by $\tau^*$.




Now consider the payoffs $P\in \mathcal {P}^*$ such that the associated steady state debt $b^*>\mathcal{B}$. Under the guess $T_t=0$, the same algebra as in Theorem \ref{thm: rep agent general theorem} goes through and we can show that $\tilde b\_=b^*$ is a steady state for the heterogeneous agent economy. Thus the heterogeneous agent economy for a given $P\in \mathcal{P}^*$ has a continuum of steady states given by the set $[\overline b, \quad \mathcal{B}] \cup \{b^*\}$.



In the region $\tilde b\_>b^*$, as before $\mu_t$ is supermartingale bounded below by $b^*$. Since there is a unique fixed point in the region $\tilde b\_ \in [b^*, \overline b^{n}]$, $\mu_t$ converges to $\mu^*$ associated with $b^*$. Transfers are zero and taxes are given by $\tau^{**}$


\begin{equation}
\tau^{**} = \frac{\gamma\mu^*}{(1+\gamma)\mu^*-1}
\end{equation}



In the region $[\mathcal{B},\quad b^*]$ the outcomes depend on the exact sequence of shocks we can show that $\mu_t$ is a submartingale. This follows from the observation that for all $\tilde b\_\geq \mathcal{B}$, we have $T(s)=0$ and the outcomes from the representative agent economy allow us to order $\mu(s)$ relative $P(s)$. At $\tilde{b}\_=\mathcal{B}$, $\mu(s)=\omega-n$ and is constant. Thus in the region $[\mathcal{B},\quad B^*]$, $\mu_t$ is sub martingale and it converges. However f $\tilde b_t$ gets sufficiently close to $\check b$, then it can converge to $\mathcal{B}$ and if it gets sufficiently close to $b^*$, it can converge to $b^*$. Either of this can happen with strictly positive probability.
\end{proof}


\newpage

\subsection{Proof of Theorem \protect\ref{prop: long run forces}}

The Bellman equation for the optimal planners problem with log quadratic
preferences and IID shocks can be written as
\begin{equation*}
V(x,\rho) = \max_{c_1,c_2,l_1,x^{\prime },\rho^{\prime }} \sum_s \pi(s)\left[%
\alpha_1\left(\log c_1(s) -\frac{l_1(s)^2}{2}\right)+\alpha_2\log
c_2(s)+\beta V(x^{\prime }(s),\rho^{\prime }(s))\right]
\end{equation*}%
subject to the constraints
\begin{align}
1+\rho^{\prime }(s)[l_1(s)^2-1]+\beta x^{\prime }(s) - \frac{x\frac{P(s)}{%
c_2(s)}}{\mathbb{E}[\frac{P(s)}{c_2(s)}]}=0  \label{eq.conStart} \\
\mathbb{E}\frac{P(s)}{c_1(s)}(\rho^{\prime }(s)-\rho) = 0 \\
\theta_1(s)l_1(s) -c_1(s)-c_2(s)-g = 0 \\
\rho^{\prime }(s) c_2(s)-c_1(s) = 0  \label{eq.conEnd}
\end{align}
where the $\pi(s)$ is the probability distribution of the aggregate state $s$. If
we let $\pi(s)\mu(s)$, $\lambda$, $\pi(s)\xi(s)$ and $\pi(s)\phi(s)$ be the
Lagrange multipliers for the constraints (\ref{eq.conStart})-(\ref{eq.conEnd}%
) respectively then we obtain the following FONC for the planners problem \footnote{Appendix \ref{apndx: numerical methods} discuses the associated second order conditions that ensure these policies are optimal}

\begin{enumerate}
\item[$c_1(s):$]
\begin{equation}
\frac{\alpha_1\pi(s)}{c_1(s)}-\frac{\lambda \pi(s)}{c_1(s)^2}(\rho^{\prime
}(s)-\rho)-\pi(s)\xi(s)-\pi(s)\phi(s) = 0  \label{eq.c1FOC}
\end{equation}

\item[$c_2(s):$]
\begin{equation}
\frac{\alpha_2 \pi(s)}{c_2(s)} + \frac{x P(s)\pi(s)}{c_2(s)^2\mathbb{E}[\frac{P}{c_2}]}%
\left[\mu(s)-\frac{\mathbb{E}[\mu\frac{P}{c_2}]}{\mathbb{E}[\frac{P}{c_2}]}%
\right]-\pi(s)\xi(s)+\pi(s)\rho^{\prime }(s)\phi(s)=0  \label{eq.c2FOC}
\end{equation}

\item[$l_1(s):$]
\begin{equation}
-\alpha_1\pi(s)l_1(s)+2\mu(s)\pi(s)\rho^{\prime
}(s)l_1(s)+\theta_1(s)\pi(s)\xi(s)=0
\end{equation}

\item[$x^{\prime }(s):$]
\begin{equation}
V_x(x^{\prime }(s),\rho^{\prime }(s)) + \mu(s) = 0
\label{eq.x'FOC}
\end{equation}

\item[$\rho^{\prime }(s):$]
\begin{equation}
 \beta V_{\rho}(x^{\prime }(s),\rho^{\prime }(s))+\frac{\lambda \pi(s)}{%
c_1(s)}+\mu(s)[l_1(s)^2-1]+\pi(s)\phi(s)c_2(s) = 0  \label{eq.FOCNend}
\end{equation}
\end{enumerate}

In addition there are two envelope conditions given by
\begin{align}
V_x(x,\rho) = -\sum_{s^{\prime }}\frac{\mu(s^{\prime })\pi(s^{\prime
})\frac{P(s)}{c_2(s^{\prime })}}{\mathbb{E}[\frac{P}{c_2}]} = -\frac{\mathbb{E}%
[\mu\frac{P}{c_2}]}{\mathbb{E}[\frac{P}{c_2}]} \\
V_{\rho}(x,\rho) = -\lambda\mathbb{E}[\frac{P}{c_1}]  \label{eq.rho_env}
\end{align}

In the steady state, we need to solve for a collection of allocations, initial conditions and Lagrange multipliers $%
\{c_1(s),c_2(s),l_1(s),x,\rho,\mu(s),\lambda,\xi(s),\phi(s)\}$ such that
equations (\ref{eq.conStart})-(\ref{eq.rho_env}) are satisfied when $%
\rho^{\prime }(s) = \rho$ and $x^{\prime }(s) = x$. It should be clear that if we replace $\mu(s) = \mu$, equation (\ref{eq.x'FOC})  and the envelope condition with respect to $x$ is
always satisfied. Additionally under this assumption equation (\ref{eq.c2FOC}%
) simplifies significantly,since
\begin{align*}
\frac{xP(s)\pi(s)}{c_2(s)^2\mathbb{E}[\frac{P}{c_2}]}\left[\mu(s)-\frac{\mathbb{E}%
[\mu\frac{P}{c_2}]}{\mathbb{E}[\frac{P}{c_2}]}\right] = 0
\end{align*}
The first order conditions for a
steady can then be written simply as
\begin{align}
1+\rho[l_1(s)^2-1]+\beta x-\frac{x P(s)}{ c_2(s)\mathbb{E}[\frac{P}{c_2}]} = 0
\label{eq.imp} \\
\theta_1(s) l_1(s) - c_1(s)-c_2(s)-g=0  \label{eq.res} \\
\ \rho c_2(s)-c_1(s) = 0  \label{eq.rhoFOC} \\
\frac{\alpha_1}{c_1(s)}-\xi(s)-\phi(s) = 0  \label{eq.c1} \\
\frac{\alpha_2}{c_2(s)}-\xi(s)+\rho\phi(s) = 0  \label{eq.c2} \\
[2\mu \rho-\alpha_1]l_1(s)+\theta_1(s)\xi(s) = 0  \label{eq.l1} \\
\lambda\left(\frac{P(s)}{c_1(s)}-\beta\mathbb{E}\left[\frac{P}{c_1}\right]\right)+\mu[%
l_1(s)^2-1]+\phi(s)c_2(s) = 0  \label{eq.R}
\end{align}
We can rewrite equation (\ref{eq.c1}) as
\begin{equation*}
\frac{\alpha_1}{c_2(s)} - \rho\xi(s) -\rho\phi(s) = 0
\end{equation*}%
by substituting $c_1(s) = \rho c_2(s)$. Adding this to equation (\ref{eq.c2}%
) and normalizing $\alpha_1+\alpha_2 = 1$ we obtain
\begin{equation}
\xi(s) = \frac1{\left(1+\rho\right)c_2(s)}\label{eq.xi}
\end{equation}%
which we can use to solve for $\phi(s)$ as
\begin{equation}
\phi(s) = \frac{\alpha_1-\rho\alpha_2}{\left(\rho(1+\rho)\right)c_2(s)}
\label{eq.phi}
\end{equation}
From equation (\ref{eq.imp}) we can solve for $l_1(s)^2 -1$ as
\begin{equation*}
l_1(s)^2-1 = \frac{x}{\rho\mathbb{E}[\frac{P}{c_2}]}\left(\frac
{P(s)}{c_2(s})-\beta\mathbb{E}\left[\frac{P}{c_2}\right]\right)-\frac1\rho
\end{equation*}%
This can be used along with equations (\ref{eq.R}) and (\ref{eq.phi}) to
obtain
\begin{equation*}
\left(\frac\lambda \rho+\frac{\mu x}{\rho\mathbb{E}[\frac{P}{c_2}]}%
\right)\left(\frac{P(s)}{c_2(s)}-\beta\mathbb{E}\left[\frac{P}{c_2}\right]%
\right) = \frac{\mu}{\rho}+\frac{\rho\alpha_2-\alpha_1}{\rho(1+\rho)}
\end{equation*}
Note that the LHS depends on $s$ while the RHS does not, hence the solution to
this equation is
\begin{equation}
\lambda = - \frac{\mu x}{\mathbb{E}[\frac{P}{c_2}]}
\end{equation}%
and
\begin{equation}
\mu = \frac{\alpha_1-\rho\alpha_2}{1+\rho}  \label{eq.mu}
\end{equation}
Combining these with equation (\ref{eq.l1}) we quickly obtain that
\begin{equation*}
\left[2\rho\frac{\alpha_1-\rho\alpha_2}{1+\rho}-\alpha_1\right]%
l_1(s)+\frac{\theta_1(s)}{\left(1+\rho\right)c_2(s)} = 0
\end{equation*}%
Then solving for $l_1(s)$ gives
\begin{equation*}
l_1(s) = \frac{\theta_1(s)}{\left(\alpha_1(1-\rho)+2\rho^2\alpha_2\right)c_2(s)}
\end{equation*}

\begin{remark}
Note that the labor tax rate is given by $1-\frac{c_1(s)l_1(s)}{\theta(s)}$. The previous expression shows that labor taxes are constant at the steady state. This property holds generally for CES preferences separable in consumption and leisure
\end{remark}

This we can plug into the aggregate resource constraint (\ref{eq.res}) to
obtain
\begin{equation*}
l_1(s) = \left(\frac{1+\rho}{\alpha_1(1-\rho)+2\rho^2\alpha_2}\right)\frac{1}{l_1(s)} +
\frac{g}{\theta_1(s)}
\end{equation*}%
letting $C(\rho) = \frac{1+\rho}{\alpha_1(1-\rho)+2\rho^2\alpha_2}$ we can
then solve for $l_1(s)$ as
\begin{equation*}
l_1(s) = \frac{g\pm\sqrt{g^2+4C(\rho)\theta_1(s)^2}}{2\theta_1(s)}
\end{equation*}
The marginal utility of agent 2 is then
\begin{equation*}
\frac1{c_2(s)} = \left(\frac{1+\rho}{C(\rho)}\right)\left(\frac{g\pm\sqrt{g^2+4C(\rho)%
\theta_1(s)^2}}{2\theta_1(s)^2}\right)
\end{equation*}%
Note that in order for either of these terms to be positive we need $%
C(\rho)\geq 0$ implying that there is only one economically meaningful root.
Thus
\begin{equation}
l_1(s) = \frac{g+\sqrt{g^2+4C(\rho)\theta_1(s)^2}}{2\theta_1(s)}
\end{equation}
and
\begin{equation}
\frac1{c_2(s)} = \left(\frac{1+\rho}{C(\rho)}\right)\left(\frac{g+\sqrt{g^2+4C(\rho)%
\theta_1(s)^2}}{2\theta_1(s)^2} \right) \label{eq.uc2}
\end{equation}
A steady state is then a value of $\rho$ such that
\begin{equation}
x(s) = \frac{1+\rho[l_1(\rho,s)^2-1]}{\frac{P(s)/c_2(\rho,s)}{\mathbb{E}%
[\frac{P}{c_2}](\rho)}-\beta}  \label{eq.xSS}
\end{equation}%
s independent of $s$.

The following lemma, which orders consumption and labor across states, will
be useful in proving the parts of proposition \ref{prop: long run forces}.  As a notational aside we
will often use $\theta_{1,l}$ and $\theta_{1,h}$ to refer to $%
\theta_{1}(s_l) $ and $\theta_{1}(s_h)$ respectively. Where $s_l$ refers to
the low TFP state and $s_h$ refers to the high TFP state.

\begin{lemma}
Suppose that $\theta_1(s_l) < \theta_2(s_h)$ and $\rho$ such that $C(\rho) >
0$ then
\begin{equation*}
l_{1,l} = \frac{g+\sqrt{g^2+4C(\rho)\theta_{1,l}^2}}{2\theta_{1,l}} > \frac{%
g+\sqrt{g^2+4C(\rho)\theta_{1,h}^2}}{2\theta_{1,h}} = l_{1,h}
\end{equation*}
and
\begin{equation*}
\frac1{c_{2,l}} = \frac{1+\rho}{C(\rho)}\frac{g+\sqrt{g^2+4C(\rho)%
\theta_{1,l}^2}}{2\theta_{1,l}^2} > \frac{1+\rho}{C(\rho)}\frac{g+\sqrt{%
g^2+4C(\rho)\theta_{1,h}^2}}{2\theta_{1,h}^2} = \frac1{c_{2.h}}
\end{equation*}%
\label{lem.1}
\end{lemma}

\begin{proof}
The results should follow directly from showing that
the function
\begin{equation*}
l_1(\theta) = \frac{g+\sqrt{g^2+4C(\rho)\theta}}{2\theta}
\end{equation*}%
is decreasing in $\theta$. Taking the derivative with respect to $\theta$
\begin{align*}
\frac{d l_1}{d\theta}(\theta) &=- \frac g{2\theta^2}-\frac{\sqrt{%
g+4C(\rho)\theta^2}}{2\theta^2} +\frac{4C(\rho)\theta}{2\theta\sqrt{%
g^2+4C(\rho)\theta^2}} \\
&=-\frac g{2\theta^2}-\frac{g+4C(\rho)\theta^2-4C(\rho)\theta^2}{2\theta^2%
\sqrt{g^2+4C(\rho)\theta^2}} \\
&=-\frac g{2\theta^2}-\frac{g}{2\theta^2\sqrt{g^2+4C(\rho)\theta^2}}<0
\end{align*}
That $\frac1{c_{2,l}}>\frac1{c_{2,h}}$ follows directly.
\end{proof}

Now we use these lemma to prove the part 1 and part 2 of theorem \ref{thm long run forces}



\begin{proof}

\textbf {[Part 1.]} For a riskfree bond when $P(s)=1$.
In order for there to exist a $\rho$ such that equation (\ref%
{eq.xSS}) is independent of the state (and hence have a steady state) we
need the existence of root for the following function
\begin{equation*}
f (\rho) = \frac{1+\rho[l_1(\rho,s_h)^2-1]}{1+\rho[l_1(\rho,s_l)^2-1]}-\frac{%
\frac{1/c_2(\rho,s_h)}{\mathbb{E}[\frac{P}{c_2}](\rho)}-\beta }{\frac{%
1/c_2(\rho,s_l)}{\mathbb{E}[\frac{P}{c_2}](\rho)}-\beta}
\end{equation*}
From lemma \ref{lem.1} we can conclude that
\begin{equation}
1+\rho[l_1(\rho,s_l)^2-1] > 1+\rho[l_1(\rho,s_h)^2-1]  \label{eq.inc_order}
\end{equation}%
and
\begin{equation}
\frac{1/c_2(\rho,s_l)}{\mathbb{E}[\frac{P}{c_2}](\rho)}-\beta >\frac{%
1/c_2(\rho,s_h)}{\mathbb{E}[\frac{P}{c_2}](\rho)}-\beta  \label{eq.int_order}
\end{equation}%
for all $\rho > 0$ such that $C(\rho)\geq 0$. To begin with we will define $%
\underline \rho$ such that $C(\rho) > 0$ for all $\rho > \underline\rho$.
Note that we will have to deal with two different cases.

\begin{description}
\item[$\protect\alpha_1(1-\protect\rho)+2\protect\rho^2\protect\alpha_2 > 0$
for all $\protect\rho\geq 0$:] In this case we know that $C(\rho)\geq 0$ for
all $\rho$ and is bounded above and thus we will let $\underline \rho =0$.

\item[$\protect\alpha_1(1-\protect\rho)+2\protect\rho^2\protect\alpha_2 = 0$
for some $\protect\rho>0$:] In this case let $\underline \rho$ be the
largest positive root of $\alpha_1(1-\rho)+2\rho^2\alpha_2$. Note that $%
\lim_{\rho\rightarrow \underline \rho^+}C(\rho) = \infty$
\end{description}

With this we note that\footnote{In the first case $\underline {\rho}=0$ and in the second case $l_1(\rho,s_l)=l_1(\rho,s_h)$ as $\rho \to \underline{\rho}^{+}$}
\begin{equation*}
\lim_{\rho\rightarrow \underline \rho^+} \frac{1+\rho[l_1(\rho,s_h)^2-1]}{1+%
\rho[l_1(\rho,s_l)^2-1]} = 1
\end{equation*}%
We can also show that
\begin{equation*}
\lim_{\rho\rightarrow\underline \rho^+} \frac{\frac{1/c_2(\rho,s_h)}{\mathbb{%
E}[\frac{P}{c_2}](\rho)}-\beta }{\frac{1/c_2(\rho,s_l)}{\mathbb{E}%
[\frac{P}{c_2}](\rho)}-\beta} < 1
\end{equation*}
which implies that $\lim_{\rho\rightarrow \underline \rho^+} f(\underline
\rho) > 0$.

Taking the limit as $\rho\rightarrow\infty$ we see that $C(\rho)\rightarrow
0 $, given that $\frac g{\theta(s)} <1$, we can then conclude that
\begin{equation*}
\lim_{\rho\rightarrow\infty } 1+ \rho[l_1(\rho,s)^2-1] = -\infty
\end{equation*}
Thus, there exists $\overline \rho$ such that $1+\overline \rho[%
l_1(\overline \rho,s_l)^2-1] = 0$. \footnote{This can be seen from the fact $\lim_{\rho\rightarrow \underline
\rho^+} 1+\rho[l_1(\rho,s_l)^2 -1] > 0$ and $\lim_{\rho\rightarrow \infty } 1+\rho[l_1(\rho,s_l)^2 -1] > -\infty$, thus $\overline{\rho}$ exists in $(\underline{\rho},\infty)$ } From equation (\ref{eq.inc_order}), we
know that
\begin{equation*}
0 = 1+\overline \rho[l_1(\overline \rho,s_l)^2-1] > 1+\overline \rho[%
l_1(\overline \rho,s_h)^2-1]
\end{equation*}
which implies in the limit
\begin{equation*}
\lim_{\rho\rightarrow \overline \rho^-}\frac{1+\rho[l_1(\rho,s_h)^2-1]}{1+%
\rho[l_1(\rho,s_l)^2-1]} = -\infty
\end{equation*}
which along with
\begin{equation*}
\frac{\frac{1/c_2(\rho,s_h)}{\mathbb{E}[\frac{P}{c_2}]}-\beta }{\frac{%
1/c_2(\rho,s_l)}{\mathbb{E}[\frac{P}{c_2}]}-\beta} \geq -1
\end{equation*}
allows us to conclude that $\lim_{\rho\rightarrow \overline \rho^-} f(\rho)
= -\infty$. The intermediate value theorem then implies that there exists $%
\rho_{SS}$ such that $f(\rho_{SS}) = 0$ and hence that $\rho_{SS}$ is a
steady state.

Finally, as $\rho_{SS} < \overline \rho$ we know that
\begin{equation*}
1+\rho_{SS}[l_1(\rho_{SS},s_l)-1] >0
\end{equation*}%
as $\frac{1/c_2(\rho,s_l)}{\mathbb{E}[\frac{P}{c_2}]} >1$ we can
conclude
\begin{equation*}
x_{SS} = \frac{1+\rho_{SS}[l_1(\rho_{SS},s_l)-1]}{\frac{1/c_2(\rho,s_l)}{%
\mathbb{E}[\frac{P}{c_2}](\rho)}-\beta} >0
\end{equation*}%
implying that the government will hold assets in the steady state (under the
normalization that agent 2 holds no assets).

\textbf {[Part 2]} As noted before, since $g/\theta (s)<1$ for all $s$ we have
\begin{equation*}
\lim_{\rho \rightarrow \infty }1+\rho \lbrack l_{1}(\rho ,s)^{2}-1]=-\infty
\end{equation*}%
Thus, there exists $\rho_{SS}$ such that
\begin{equation*}
0>1+\rho_{SS}[l_{1}(\rho_{SS},s_{l})^{2}-1]>1\rho_{SS}[l_{1}(\rho_{SS},s_{h})^{2}-1]
\end{equation*}%
It is then possible to choose $P (s)$ such that $\beta <\frac{P(s)/c_{2}(\rho_{SS},s)}{%
\mathbb{E}[\frac{P}{c_{2}}]}$ such that
\begin{equation}
1>\frac{1+\rho_{SS}[l_{1}(\rho_{SS},s_{l})^{2}-1]}{1+\rho_{SS}[l_{1}(\rho_{SS},s_{h})^{2}-1]}=\frac{\frac{P(s_l)/c_{2}(\rho_{SS},s_{l})%
}{\mathbb{E}[\frac{P}{c_{2}}]}-\beta}{\frac{%
P(s_h)/c_{2}(\rho_{SS},s_{h})}{\mathbb{E}[\frac{P}{c_{2}}]}%
-\beta }  \label{eq.beta_cond}
\end{equation}%
Implying that for Payoff shocks $P(s)$, $\rho_{SS}$ is a
steady state level for the ratio of marginal utilities, with steady state
marginal utility weighted government debt
\begin{equation*}
x_{SS}=\frac{1+\rho_{SS}[l_{1}(\rho_{SS},s_{l})^{2}-1]}{\frac{%
P(s_l)/c_{2}(\rho_{SS},s_{l})}{\mathbb{E}[\frac{P}{c_{2}}]}%
-\beta}<0
\end{equation*}%
Thus, in the steady state, the government is holding debt, under the
normalization that the unproductive worker holds no assets. Note this imposes a restriction of $\frac{P(s_l)}{P(s_h)}$.

\[\frac{P(s_l)c_2^{-1}(\rho_{SS},s_l)-\beta \mathbb{E}Pc_2^{-1}}{P(s_h)c_2^{-1}(\rho_{SS},s_h)-\beta \mathbb{E}Pc_2^{-1}}<1\]
or

\[\frac{P(s_l)}{P(s_h)}<\frac{c_2^{-1}(\rho_{SS},s_h)}{c_2^{-1}(\rho_{SS},s_l)}<1\]

or 

Thus $P(s_l)<P(s_h)$ i.e payoffs have to be sufficiently procyclical.

\end{proof}

    


\end{proof}
 






\end{document}
